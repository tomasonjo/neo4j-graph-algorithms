[[algorithms-balanced-triads]]
= The Balanced Triads algorithm

[abstract]
--
This section describes the Balanced Triads algorithm in the Neo4j Graph Algorithms library.
--

// tag::introduction[]
<intro text>
http://www.bertramgawronski.com/documents/G2007EncycBT.pdf

https://www2.bc.edu/arch-woodside/sep%2021heider%20balance%20theory.pdf
// end::introduction[]


[[algorithms-balanced-triads-context]]
== History and explanation

// tag::explanation[]

https://en.wikipedia.org/wiki/Balance_theory

https://en.wikipedia.org/wiki/Signed_graph
all the text

// end::explanation[]


[[algorithms-balanced-triads-usecase]]
== Use-cases - when to use the Balance Triads algorithm

// tag::use-case[]
https://www.maths.ed.ac.uk/~antal/Mypapers/friends05.pdf
https://www.maths.ed.ac.uk/~antal/Mypapers/friends06.pdf
https://www.researchgate.net/publication/2146676/download
https://cs.stanford.edu/~jure/pubs/triads-chi10.pdf
https://pdfs.semanticscholar.org/7c23/cdd36ea05a09a8de7dcc6c7571537f279439.pdf
http://mrvar.fdv.uni-lj.si/pajek/SignedNetworks/Bled94.pdf
https://www.tau.ac.il/~geffene/PDFs/93-Anim_Behav_2013b.pdf
http://ceur-ws.org/Vol-1710/paper38.pdf
* one
* two
* threee
// end::use-case[]


[[algorithms-balanced-triads-sample]]
== Balanced Triads algorithm sample

This sample will explain the Balanced Triads algorithm, using a simple graph:

image::balanced_triads.png[]

.The following will create a sample graph:
[source, cypher]
----
include::scripts/balanced-triads.cypher[tag=create-sample-graph]
----

.The following will count the number of balanced and unbalanced triads that a node is a member of, and return a stream with `nodeId`, `balanced` and 'unbalanced':
[source, cypher]
----
include::scripts/balanced-triads.cypher[tag=stream-sample-graph]
----

.The following will count the number of balanced and unbalanced triads that a node is member of, and write it back. It will return the total balanced triads and unbalanced triads count of the given graph:
[source, cypher]
----
include::scripts/balanced-triads.cypher[tag=write-sample-graph]
----

// tag::stream-sample-graph-result[]
.Results
[opts="header",cols="1,1,1"]
|===
| nodeId  | balanced | unbalanced
| Anna    | 3        | 3
| Matt    | 1        | 1
| Larry   | 1        | 1
| Stefan  | 1        | 1
| Sophia  | 1        | 1
| Dolores | 1        | 1
|===
// end::stream-sample-graph-result[]


// tag::stream-sample-graph-explanation[]
We can see that there are `KNOWS` triangles containing "Will, Michael, and Chris", "Will, Mark, and Michael", and "Michael, Karin, and Chris".
This means that everybody in the triangle knows each other.
// end::stream-sample-graph-explanation[]


[[algorithms-balanced-triads-example]]
== Example usage

[[algorithms-balanced-triads-syntax]]
== Syntax

.The following will count the number of triangles that a node is a member of, and return a stream with `nodeId` and `triangleCount`:
[source, cypher]
----
CALL algo.balancedTriads.stream(label:String, relationship:String, {concurrency:4})
YIELD nodeId, balanced, unbalanced
----

.Parameters
[opts="header",cols="1,1,1,1,4"]
|===
| Name           | Type   | Default        | Optional | Description
| label          | string | null           | yes      | The label to load from the graph. If null, load all nodes
| relationship   | string | null           | yes      | The relationship-type to load from the graph. If null, load all relationships
| weightProperty | string | null           | no       | The property name that contains weight. If null, treats the graph as unweighted. Must be numeric.
| concurrency    | int    | available CPUs | yes      | The number of concurrent threads
|===

.Results
[opts="header",cols="1,1,6"]
|===
| Name       | Type | Description
| nodeId     | int  | The ID of node
| balanced   | int  | The number of balanced triads a node is member of
| unbalanced | int  | The number of unbalanced a node is member of
|===

.The following will count the number of triangles that a node is a member of, and write it back. It will return the total triangle count and average clustering coefficient of the given graph:
[source, cypher]
----
CALL algo.balancedTriads(label:String, relationship:String,
  {concurrency:4, write:true, weightProperty:'weight', balancedProperty:'balanced', unbalancedProperty:'unbalanced'})
YIELD loadMillis, computeMillis, writeMillis, nodeCount, balancedTriadCount, unbalancedTriadCount
----

.Parameters
[opts="header",cols="1,1,1,1,4"]
|===
| Name                          | Type    | Default        | Optional | Description
| label                         | string  | null           | yes      | The label to load from the graph. If null, load all nodes
| relationship                  | string  | null           | yes      | The relationship-type to load from the graph. If null, load all relationships
| concurrency                   | int     | available CPUs | yes      | The number of concurrent threads
| weightProperty                | string  | null           | no       | The property name that contains weight. If null, treats the graph as unweighted. Must be numeric.
| balancedProperty              | string  | 'balanced'     | yes      | The property name written back to the count of balanced triads a node is member of
| unbalancedProperty            | string  | 'unbalanced'   | yes      | The property name written back to the count of unbalanced triads a node is member of
| write                         | boolean | true           | yes      | Specifies if the result should be written back as a node property

|===

.Results
[opts="header",cols="1,1,6"]
|===
| Name                         | Type  | Description
| nodeCount                    | int   | The number of nodes considered
| loadMillis                   | int   | Milliseconds for loading data
| evalMillis                   | int   | Milliseconds for running the algorithm
| writeMillis                  | int   | Milliseconds for writing result data back
| balancedTriadCount           | int   | The number of balanced triads in the given graph
| unbalancedTriadCount         | int   | The number of unbalanced triads in the given graph
|===


== Graph type support

The Balanced Triads algorithm support the following graph type:

* [x] undirected, weighted


ifndef::env-docs[]
== References

// tag::references[]
* a
* b
* c
// end::references[]
endif::env-docs[]
